 <%@ Language=VBScript %><%Response.Buffer = True%><%currtime = convertTime(now())visIP = Request.ServerVariables("REMOTE_ADDR")referpage = request.querystring("ref")thepage = request.servervariables("URL")hitpage = request.querystring("page")hitpage = right(hitpage, len(hitpage)-7)thepos=0found = truewhile found	currpos = instr(thepos+1,thepage,"/")	if currpos > thepos then		thepos = currpos	end if	if currpos = 0 then		found = false	end ifwendactpage = mid(thepage,thepos+1,len(thepage) - thepos)rootdir = left(thepage,len(thepage)-len(actpage))statdbpath = Server.MapPath(".")if thepos > 1 thenstatdbpath = left(statdbpath,(len(statdbpath) - len(rootdir) +1))end ifstatdbpath = statdbpath & "\stats\statsdb.mdb"if referpage = "" then	referpage = "Bookmark"else	referpage = right(referpage,len(referpage)-7)end ifslashpos = instr(hitpage,"/")hitpage = right(hitpage, len(hitpage)-slashpos)if hitpage="" then	hitpage="index page"end iftheconnection = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & statdbpathSet statConn = Server.CreateObject("ADODB.Connection")Set SRS = Server.CreateObject("ADODB.Recordset")statConn.Open theconnectiontime24 = convertTime(DateAdd("d","-1",now()))ssql = "select * from SiteCount where IP='" & visIP & "' and Date >= '" & time24 & "'"SRS.Open ssql, statConn, 3,3if SRS.EOF then	SRS.addnew	SRS("IP") = visIP	SRS("Refer") = referpage	SRS("Date") = currtime	SRS("PageIn") = hitpage	SRS("Count") = 1	SRS.Updateend ifSRS.Closessql = "select * from PageCount where IP='" & visIP & "' and Date >= '" & time24 & "' and Page ='" & hitpage &"'"SRS.Open ssql, statConn, 3,3if SRS.EOF then	SRS.addnew	SRS("IP") = visIP	SRS("Date") = currtime	SRS("Page") = hitpage	SRS("Count") =1	SRS.Updateend ifSRS.ClosestatConn.CloseSet SRS = nothingSet statConn = nothingresponse.write "&nbsp;"	Function convertTime(timein)			timeout = Year(timein)		if month(timein) < 10 then			timeout = timeout & "0"		end if		timeout = timeout & month(timein)		if day(timein) < 10 then			timeout = timeout & "0"		end if		timeout = timeout & day(timein)		if hour(timein) < 10 then			timeout = timeout & "0"		end if		timeout = timeout & hour(timein)		if minute(timein) < 10 then			timeout = timeout & "0"		end if		timeout = timeout & minute(timein)		if second(timein) < 10 then			timeout = timeout & "0"		end if		timeout = timeout & second(timein)	convertTime=timeoutend function%>